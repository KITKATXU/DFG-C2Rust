#![allow(non_camel_case_types)]
#![allow(dead_code)]

pub type ush = u16;
pub type uch = u8;
pub type ulg = u32;
pub type off_t = i64;

/* Translation of the C unions */
#[repr(C)]
#[derive(Debug, Default, Clone, Copy)]
pub union fc {
    pub freq: ush,
    pub code: ush,
}

#[repr(C)]
#[derive(Debug, Default, Clone, Copy)]
pub union dl {
    pub dad: ush,
    pub len: ush,
}

/* Translation of struct ct_data */
#[repr(C)]
#[derive(Debug, Default, Clone, Copy)]
pub struct ct_data {
    pub fc: fc,
    pub dl: dl,
}

/* Enums to replace pointer fields in tree_desc */
#[derive(Debug, Clone, Copy)]
pub enum TreePointer {
    DynLtree,
    DynDtree,
    BlTree,
    StaticLtree,
    StaticDtree,
    None,
}

#[derive(Debug, Clone, Copy)]
pub enum ExtraBitsPointer {
    ExtraLbits,
    ExtraDbits,
    ExtraBlbits,
    None,
}

/* Translation of struct tree_desc */
#[repr(C)]
#[derive(Debug, Default, Clone, Copy)]
pub struct tree_desc {
    pub dyn_tree: TreePointer,   
    pub static_tree: TreePointer,
    pub extra_bits: ExtraBitsPointer,
    pub extra_base: i32,
    pub elems: i32,
    pub max_length: i32,
    pub max_code: i32,
}

/* Enums to replace file_type and file_method pointers */
#[derive(Debug, Clone, Copy)]
pub enum FileTypeIndicator {
    Unknown,
    Binary,
    Ascii,
}

#[derive(Debug, Clone, Copy)]
pub enum FileMethodIndicator {
    Deflate,
    Store,
}

/* A single state struct to hold all former globals */
#[derive(Default)]
pub struct State {
    pub extra_lbits: [i32; 29],
    pub extra_dbits: [i32; 30],
    pub extra_blbits: [i32; 19],

    pub dyn_ltree: [ct_data; 573],
    pub dyn_dtree: [ct_data; 61],
    pub static_ltree: [ct_data; 288],
    pub static_dtree: [ct_data; 30],
    pub bl_tree: [ct_data; 39],

    pub l_desc: tree_desc,
    pub d_desc: tree_desc,
    pub bl_desc: tree_desc,

    pub bl_count: [ush; 17],
    pub bl_order: [uch; 19],

    pub heap: [i32; 573],
    pub heap_len: i32,
    pub heap_max: i32,

    pub depth: [uch; 573],

    pub length_code: [uch; 256],
    pub dist_code: [uch; 512],
    pub base_length: [i32; 29],
    pub base_dist: [i32; 30],

    pub flag_buf: [uch; 4096],
    pub last_lit: u32,
    pub last_dist: u32,
    pub last_flags: u32,
    pub flags: uch,
    pub flag_bit: uch,

    pub opt_len: ulg,
    pub static_len: ulg,
    pub compressed_len: off_t,
    pub input_len: off_t,

    pub file_type: FileTypeIndicator,
    pub file_method: FileMethodIndicator,

    pub block_start: i64,
    pub strstart: u32,
}